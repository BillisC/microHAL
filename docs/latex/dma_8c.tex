\doxysection{src/drivers/dma.c File Reference}
\hypertarget{dma_8c}{}\label{dma_8c}\index{src/drivers/dma.c@{src/drivers/dma.c}}


Function defines the DMA driver.  


{\ttfamily \#include "{}dma.\+h"{}}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{dma_8c_aed39ce334b5dd6cebf59185a5cde3bf7}{dma\+\_\+set\+\_\+addresses}} (const \mbox{\hyperlink{dma_8h_a52b50d9b580890a3a99d6e452e540f05}{dma\+\_\+peripheral\+\_\+t}} dma, const uint8\+\_\+t stream, const uint32\+\_\+t PA, const uint32\+\_\+t M0A, const uint32\+\_\+t M1A)
\begin{DoxyCompactList}\small\item\em Set the DMA source and destination addresses. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{dma_8c_a57a92af2d585c5179c5bebcb0e42a159}{dma\+\_\+configure\+\_\+data}} (const \mbox{\hyperlink{dma_8h_a52b50d9b580890a3a99d6e452e540f05}{dma\+\_\+peripheral\+\_\+t}} dma, const uint8\+\_\+t stream, const uint16\+\_\+t count, const \mbox{\hyperlink{dma_8h_a1732e13bbb47e74a2237ea590425326a}{dma\+\_\+datasize\+\_\+t}} msize, const \mbox{\hyperlink{dma_8h_a1732e13bbb47e74a2237ea590425326a}{dma\+\_\+datasize\+\_\+t}} psize)
\begin{DoxyCompactList}\small\item\em Set DMA transfers to specified configuration. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{dma_8c_a1fe21db110dae1687ace3d097a4d558e}{dma\+\_\+set\+\_\+direction}} (const \mbox{\hyperlink{dma_8h_a52b50d9b580890a3a99d6e452e540f05}{dma\+\_\+peripheral\+\_\+t}} dma, const uint8\+\_\+t stream, const \mbox{\hyperlink{dma_8h_acb4c9afece395581961a451cf89a0daf}{dma\+\_\+dir\+\_\+t}} direction)
\begin{DoxyCompactList}\small\item\em Set DMA transfers to the desired direction. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{dma_8c_a317fb319e7528b1e7ce6ad0df5ccc94f}{dma\+\_\+configure\+\_\+stream}} (const \mbox{\hyperlink{dma_8h_a52b50d9b580890a3a99d6e452e540f05}{dma\+\_\+peripheral\+\_\+t}} dma, const uint8\+\_\+t stream, const struct \mbox{\hyperlink{structDMAStreamConfig}{DMAStream\+Config}} config)
\begin{DoxyCompactList}\small\item\em Set DMA stream to the specified configuration. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{dma_8c_a596dd5fdee29a7a84ebae8fdc2d1c1f7}{dma\+\_\+set\+\_\+channel}} (const \mbox{\hyperlink{dma_8h_a52b50d9b580890a3a99d6e452e540f05}{dma\+\_\+peripheral\+\_\+t}} dma, const uint8\+\_\+t stream, const uint8\+\_\+t channel, const \mbox{\hyperlink{dma_8h_a945cea4e4c15bf97a414f0a003067de6}{dma\+\_\+priority\+\_\+t}} priority)
\begin{DoxyCompactList}\small\item\em Set the DMA stream channel and priority. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{dma_8c_adb3051773cb04ea9206da23de3536f68}{dma\+\_\+set\+\_\+interrupts}} (const \mbox{\hyperlink{dma_8h_a52b50d9b580890a3a99d6e452e540f05}{dma\+\_\+peripheral\+\_\+t}} dma, const uint8\+\_\+t stream, const struct \mbox{\hyperlink{structDMAStreamISR}{DMAStream\+ISR}} config)
\begin{DoxyCompactList}\small\item\em Enabled the specified DMA stream interrupts. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{dma_8c_ada55bad0a993826be5925226ee90639a}{dma\+\_\+enable}} (const \mbox{\hyperlink{dma_8h_a52b50d9b580890a3a99d6e452e540f05}{dma\+\_\+peripheral\+\_\+t}} dma, const uint8\+\_\+t stream)
\begin{DoxyCompactList}\small\item\em Enables DMA stream transfers. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{dma_8c_abb407bc5fd74bbe66472dbbf03f9efe0}{dma\+\_\+disable}} (const \mbox{\hyperlink{dma_8h_a52b50d9b580890a3a99d6e452e540f05}{dma\+\_\+peripheral\+\_\+t}} dma, const uint8\+\_\+t stream)
\begin{DoxyCompactList}\small\item\em Disables DMA stream transfers. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Function defines the DMA driver. 

This file contains all of the function definitions declared in \doxylink{dma_8h}{dma.\+h}.

\begin{DoxyAuthor}{Author}
Vasileios Ch. (BillisC) 
\end{DoxyAuthor}
\begin{DoxyRefDesc}{Bug}
\item[\mbox{\hyperlink{bug__bug000004}{Bug}}]There is a case where DMA1 clears EN Sx\+CR bit when the peripheral address is USART2 DR. There is no workaround at the moment (is it errata?). \end{DoxyRefDesc}


\doxysubsection{Function Documentation}
\Hypertarget{dma_8c_a57a92af2d585c5179c5bebcb0e42a159}\index{dma.c@{dma.c}!dma\_configure\_data@{dma\_configure\_data}}
\index{dma\_configure\_data@{dma\_configure\_data}!dma.c@{dma.c}}
\doxysubsubsection{\texorpdfstring{dma\_configure\_data()}{dma\_configure\_data()}}
{\footnotesize\ttfamily \label{dma_8c_a57a92af2d585c5179c5bebcb0e42a159} 
void dma\+\_\+configure\+\_\+data (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{dma_8h_a52b50d9b580890a3a99d6e452e540f05}{dma\+\_\+peripheral\+\_\+t}}}]{dma}{, }\item[{const uint8\+\_\+t}]{stream}{, }\item[{const uint16\+\_\+t}]{count}{, }\item[{const \mbox{\hyperlink{dma_8h_a1732e13bbb47e74a2237ea590425326a}{dma\+\_\+datasize\+\_\+t}}}]{msize}{, }\item[{const \mbox{\hyperlink{dma_8h_a1732e13bbb47e74a2237ea590425326a}{dma\+\_\+datasize\+\_\+t}}}]{psize}{}\end{DoxyParamCaption})}



Set DMA transfers to specified configuration. 

The DMA datasizes are specified in the dma\+\_\+datasize\+\_\+t enum. Any other value will be ignored.


\begin{DoxyParams}{Parameters}
{\em dma} & The selected DMA \\
\hline
{\em stream} & The selected stream (0..7) \\
\hline
{\em count} & The total number of data items \\
\hline
{\em msize} & The size of data stored in memory \\
\hline
{\em psize} & The size of data stored in the peripheral \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
None 
\end{DoxyReturn}
\Hypertarget{dma_8c_a317fb319e7528b1e7ce6ad0df5ccc94f}\index{dma.c@{dma.c}!dma\_configure\_stream@{dma\_configure\_stream}}
\index{dma\_configure\_stream@{dma\_configure\_stream}!dma.c@{dma.c}}
\doxysubsubsection{\texorpdfstring{dma\_configure\_stream()}{dma\_configure\_stream()}}
{\footnotesize\ttfamily \label{dma_8c_a317fb319e7528b1e7ce6ad0df5ccc94f} 
void dma\+\_\+configure\+\_\+stream (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{dma_8h_a52b50d9b580890a3a99d6e452e540f05}{dma\+\_\+peripheral\+\_\+t}}}]{dma}{, }\item[{const uint8\+\_\+t}]{stream}{, }\item[{const struct \mbox{\hyperlink{structDMAStreamConfig}{DMAStream\+Config}}}]{config}{}\end{DoxyParamCaption})}



Set DMA stream to the specified configuration. 

The DMA stream options are specified in the \doxylink{structDMAStreamConfig}{DMAStream\+Config} struct.


\begin{DoxyParams}{Parameters}
{\em dma} & The selected DMA \\
\hline
{\em stream} & The selected stream (0..7) \\
\hline
{\em config} & The stream configuration \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
None 
\end{DoxyReturn}
\Hypertarget{dma_8c_abb407bc5fd74bbe66472dbbf03f9efe0}\index{dma.c@{dma.c}!dma\_disable@{dma\_disable}}
\index{dma\_disable@{dma\_disable}!dma.c@{dma.c}}
\doxysubsubsection{\texorpdfstring{dma\_disable()}{dma\_disable()}}
{\footnotesize\ttfamily \label{dma_8c_abb407bc5fd74bbe66472dbbf03f9efe0} 
void dma\+\_\+disable (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{dma_8h_a52b50d9b580890a3a99d6e452e540f05}{dma\+\_\+peripheral\+\_\+t}}}]{dma}{, }\item[{const uint8\+\_\+t}]{stream}{}\end{DoxyParamCaption})}



Disables DMA stream transfers. 


\begin{DoxyParams}{Parameters}
{\em dma} & The selected DMA \\
\hline
{\em stream} & The selected stream (0..7) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
None 
\end{DoxyReturn}
\Hypertarget{dma_8c_ada55bad0a993826be5925226ee90639a}\index{dma.c@{dma.c}!dma\_enable@{dma\_enable}}
\index{dma\_enable@{dma\_enable}!dma.c@{dma.c}}
\doxysubsubsection{\texorpdfstring{dma\_enable()}{dma\_enable()}}
{\footnotesize\ttfamily \label{dma_8c_ada55bad0a993826be5925226ee90639a} 
void dma\+\_\+enable (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{dma_8h_a52b50d9b580890a3a99d6e452e540f05}{dma\+\_\+peripheral\+\_\+t}}}]{dma}{, }\item[{const uint8\+\_\+t}]{stream}{}\end{DoxyParamCaption})}



Enables DMA stream transfers. 


\begin{DoxyParams}{Parameters}
{\em dma} & The selected DMA \\
\hline
{\em stream} & The selected stream (0..7) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
None 
\end{DoxyReturn}
\Hypertarget{dma_8c_aed39ce334b5dd6cebf59185a5cde3bf7}\index{dma.c@{dma.c}!dma\_set\_addresses@{dma\_set\_addresses}}
\index{dma\_set\_addresses@{dma\_set\_addresses}!dma.c@{dma.c}}
\doxysubsubsection{\texorpdfstring{dma\_set\_addresses()}{dma\_set\_addresses()}}
{\footnotesize\ttfamily \label{dma_8c_aed39ce334b5dd6cebf59185a5cde3bf7} 
void dma\+\_\+set\+\_\+addresses (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{dma_8h_a52b50d9b580890a3a99d6e452e540f05}{dma\+\_\+peripheral\+\_\+t}}}]{dma}{, }\item[{const uint8\+\_\+t}]{stream}{, }\item[{const uint32\+\_\+t}]{PA}{, }\item[{const uint32\+\_\+t}]{M0A}{, }\item[{const uint32\+\_\+t}]{M1A}{}\end{DoxyParamCaption})}



Set the DMA source and destination addresses. 

Usually only the peripheral and M0 addresses are needed. In that case you shall set M1A to zero.


\begin{DoxyParams}{Parameters}
{\em dma} & The selected DMA \\
\hline
{\em stream} & The selected stream (0..7) \\
\hline
{\em PA} & The peripheral address \\
\hline
{\em M0A} & The memory 0 address \\
\hline
{\em M1A} & The memory 1 address \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
None 
\end{DoxyReturn}
\Hypertarget{dma_8c_a596dd5fdee29a7a84ebae8fdc2d1c1f7}\index{dma.c@{dma.c}!dma\_set\_channel@{dma\_set\_channel}}
\index{dma\_set\_channel@{dma\_set\_channel}!dma.c@{dma.c}}
\doxysubsubsection{\texorpdfstring{dma\_set\_channel()}{dma\_set\_channel()}}
{\footnotesize\ttfamily \label{dma_8c_a596dd5fdee29a7a84ebae8fdc2d1c1f7} 
void dma\+\_\+set\+\_\+channel (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{dma_8h_a52b50d9b580890a3a99d6e452e540f05}{dma\+\_\+peripheral\+\_\+t}}}]{dma}{, }\item[{const uint8\+\_\+t}]{stream}{, }\item[{const uint8\+\_\+t}]{channel}{, }\item[{const \mbox{\hyperlink{dma_8h_a945cea4e4c15bf97a414f0a003067de6}{dma\+\_\+priority\+\_\+t}}}]{priority}{}\end{DoxyParamCaption})}



Set the DMA stream channel and priority. 

The DMA priority levels are specified in the dma\+\_\+priority\+\_\+t enum. Any other value will be ignored. Refer to the chip\textquotesingle{}s manual for the channel function matrix.


\begin{DoxyParams}{Parameters}
{\em dma} & The selected DMA \\
\hline
{\em stream} & The selected stream (0..7) \\
\hline
{\em channel} & The selected channel (0..7) \\
\hline
{\em priority} & The stream priority level \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
None 
\end{DoxyReturn}
\Hypertarget{dma_8c_a1fe21db110dae1687ace3d097a4d558e}\index{dma.c@{dma.c}!dma\_set\_direction@{dma\_set\_direction}}
\index{dma\_set\_direction@{dma\_set\_direction}!dma.c@{dma.c}}
\doxysubsubsection{\texorpdfstring{dma\_set\_direction()}{dma\_set\_direction()}}
{\footnotesize\ttfamily \label{dma_8c_a1fe21db110dae1687ace3d097a4d558e} 
void dma\+\_\+set\+\_\+direction (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{dma_8h_a52b50d9b580890a3a99d6e452e540f05}{dma\+\_\+peripheral\+\_\+t}}}]{dma}{, }\item[{const uint8\+\_\+t}]{stream}{, }\item[{const \mbox{\hyperlink{dma_8h_acb4c9afece395581961a451cf89a0daf}{dma\+\_\+dir\+\_\+t}}}]{direction}{}\end{DoxyParamCaption})}



Set DMA transfers to the desired direction. 

The DMA directions are specified in the dma\+\_\+dir\+\_\+t enum. Any other value will be ignored. After that set the addresses according to the chip\textquotesingle{}s manual.


\begin{DoxyParams}{Parameters}
{\em dma} & The selected DMA \\
\hline
{\em stream} & The selected stream (0..7) \\
\hline
{\em direction} & The transfer direction \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
None 
\end{DoxyReturn}
\Hypertarget{dma_8c_adb3051773cb04ea9206da23de3536f68}\index{dma.c@{dma.c}!dma\_set\_interrupts@{dma\_set\_interrupts}}
\index{dma\_set\_interrupts@{dma\_set\_interrupts}!dma.c@{dma.c}}
\doxysubsubsection{\texorpdfstring{dma\_set\_interrupts()}{dma\_set\_interrupts()}}
{\footnotesize\ttfamily \label{dma_8c_adb3051773cb04ea9206da23de3536f68} 
void dma\+\_\+set\+\_\+interrupts (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{dma_8h_a52b50d9b580890a3a99d6e452e540f05}{dma\+\_\+peripheral\+\_\+t}}}]{dma}{, }\item[{const uint8\+\_\+t}]{stream}{, }\item[{const struct \mbox{\hyperlink{structDMAStreamISR}{DMAStream\+ISR}}}]{config}{}\end{DoxyParamCaption})}



Enabled the specified DMA stream interrupts. 

The available DMA interrupts are located in the \doxylink{structDMAStreamISR}{DMAStream\+ISR} struct.


\begin{DoxyParams}{Parameters}
{\em dma} & The selected DMA \\
\hline
{\em stream} & The selected stream (0..7) \\
\hline
{\em config} & The interrupt configuration \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
None 
\end{DoxyReturn}
