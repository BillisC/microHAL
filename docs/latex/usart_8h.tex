\doxysection{src/drivers/usart.h File Reference}
\hypertarget{usart_8h}{}\label{usart_8h}\index{src/drivers/usart.h@{src/drivers/usart.h}}


Function prototypes for the USART interface.  


{\ttfamily \#include $<$stdint.\+h$>$}\newline
{\ttfamily \#include "{}stm32f4xx.\+h"{}}\newline
{\ttfamily \#include "{}defines.\+h"{}}\newline
\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structUSARTRegs}{USARTRegs}}
\begin{DoxyCompactList}\small\item\em Contains USART registers. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structUSARTISR}{USARTISR}}
\begin{DoxyCompactList}\small\item\em Contains USART interrupt configuration. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{usart_8h_a3977cb9899a567a850c44904025c08dc}{USART}}(x)
\end{DoxyCompactItemize}
\doxysubsubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{usart_8h_a84089acfdd6cff2f2d8a844e76bbf655}\label{usart_8h_a84089acfdd6cff2f2d8a844e76bbf655} 
typedef enum \mbox{\hyperlink{usart_8h_a239575d038ee98e4e68bab0e5c329b77}{usart\+\_\+peripheral}} {\bfseries usart\+\_\+peripheral\+\_\+t}
\begin{DoxyCompactList}\small\item\em Available USART peripherals. \end{DoxyCompactList}\item 
\Hypertarget{usart_8h_af9cb6192f394ebde038a7b64527eb5e9}\label{usart_8h_af9cb6192f394ebde038a7b64527eb5e9} 
typedef enum \mbox{\hyperlink{usart_8h_a1c465965478e0f6908a4c99d4f3ad20f}{usart\+\_\+mode}} {\bfseries usart\+\_\+mode\+\_\+t}
\begin{DoxyCompactList}\small\item\em Available USART modes. \end{DoxyCompactList}\item 
\Hypertarget{usart_8h_a646bb5cdc2347b4c446474ed4d800b28}\label{usart_8h_a646bb5cdc2347b4c446474ed4d800b28} 
typedef enum \mbox{\hyperlink{usart_8h_a224e77e9dff1a704a3b0d15e6e383709}{usart\+\_\+databits}} {\bfseries usart\+\_\+databits\+\_\+t}
\begin{DoxyCompactList}\small\item\em Available USART databit number. \end{DoxyCompactList}\item 
\Hypertarget{usart_8h_aec2fddd4341bdbc1ca7e36b9d543d6f9}\label{usart_8h_aec2fddd4341bdbc1ca7e36b9d543d6f9} 
typedef enum \mbox{\hyperlink{usart_8h_ab7d8ac715e2bd7ccddc65bf2c5ceb1f5}{usart\+\_\+stopbits}} {\bfseries usart\+\_\+stopbits\+\_\+t}
\begin{DoxyCompactList}\small\item\em Available USART stopbit number. \end{DoxyCompactList}\item 
\Hypertarget{usart_8h_a9b924d5756332a7f8773403d0dd6b708}\label{usart_8h_a9b924d5756332a7f8773403d0dd6b708} 
typedef enum \mbox{\hyperlink{usart_8h_a867cc5f0ea7d3bf651d68f0046cf6f41}{usart\+\_\+parity}} {\bfseries usart\+\_\+parity\+\_\+t}
\begin{DoxyCompactList}\small\item\em Available USART parities. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{usart_8h_a239575d038ee98e4e68bab0e5c329b77}\label{usart_8h_a239575d038ee98e4e68bab0e5c329b77} 
enum \mbox{\hyperlink{usart_8h_a239575d038ee98e4e68bab0e5c329b77}{usart\+\_\+peripheral}} 
\begin{DoxyCompactList}\small\item\em Available USART peripherals. \end{DoxyCompactList}\item 
\Hypertarget{usart_8h_a1c465965478e0f6908a4c99d4f3ad20f}\label{usart_8h_a1c465965478e0f6908a4c99d4f3ad20f} 
enum \mbox{\hyperlink{usart_8h_a1c465965478e0f6908a4c99d4f3ad20f}{usart\+\_\+mode}} \{ {\bfseries USART\+\_\+\+MODE\+\_\+\+TX} = 0x00
, {\bfseries USART\+\_\+\+MODE\+\_\+\+RX} = 0x01
, {\bfseries USART\+\_\+\+MODE\+\_\+\+BO} = 0x02
 \}
\begin{DoxyCompactList}\small\item\em Available USART modes. \end{DoxyCompactList}\item 
\Hypertarget{usart_8h_a224e77e9dff1a704a3b0d15e6e383709}\label{usart_8h_a224e77e9dff1a704a3b0d15e6e383709} 
enum \mbox{\hyperlink{usart_8h_a224e77e9dff1a704a3b0d15e6e383709}{usart\+\_\+databits}} \{ {\bfseries USART\+\_\+\+DATABITS\+\_\+\+DB8} = 0x00
, {\bfseries USART\+\_\+\+DATABITS\+\_\+\+DB9} = 0x01
 \}
\begin{DoxyCompactList}\small\item\em Available USART databit number. \end{DoxyCompactList}\item 
\Hypertarget{usart_8h_ab7d8ac715e2bd7ccddc65bf2c5ceb1f5}\label{usart_8h_ab7d8ac715e2bd7ccddc65bf2c5ceb1f5} 
enum \mbox{\hyperlink{usart_8h_ab7d8ac715e2bd7ccddc65bf2c5ceb1f5}{usart\+\_\+stopbits}} \{ {\bfseries USART\+\_\+\+STOPBITS\+\_\+\+SB1} = 0x00
, {\bfseries USART\+\_\+\+STOPBITS\+\_\+\+SBH} = 0x01
, {\bfseries USART\+\_\+\+STOPBITS\+\_\+\+SB2} = 0x02
, {\bfseries USART\+\_\+\+STOPBITS\+\_\+\+SBO} = 0x03
 \}
\begin{DoxyCompactList}\small\item\em Available USART stopbit number. \end{DoxyCompactList}\item 
\Hypertarget{usart_8h_a867cc5f0ea7d3bf651d68f0046cf6f41}\label{usart_8h_a867cc5f0ea7d3bf651d68f0046cf6f41} 
enum \mbox{\hyperlink{usart_8h_a867cc5f0ea7d3bf651d68f0046cf6f41}{usart\+\_\+parity}} \{ {\bfseries USART\+\_\+\+PARITY\+\_\+\+EVN} = 0x00
, {\bfseries USART\+\_\+\+PARITY\+\_\+\+ODD} = 0x01
, {\bfseries USART\+\_\+\+PARITY\+\_\+\+OFF} = 0x02
 \}
\begin{DoxyCompactList}\small\item\em Available USART parities. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{usart_8h_ad9c264f63f18256847b7c7b954a17d8d}{usart\+\_\+start}} (const \mbox{\hyperlink{usart_8h_a84089acfdd6cff2f2d8a844e76bbf655}{usart\+\_\+peripheral\+\_\+t}} usart, const uint32\+\_\+t baudrate, const \mbox{\hyperlink{usart_8h_af9cb6192f394ebde038a7b64527eb5e9}{usart\+\_\+mode\+\_\+t}} mode)
\begin{DoxyCompactList}\small\item\em Initiates the USART peripheral with specified options. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{usart_8h_a0455ec8a07f9dacafb4662e78c03c718}{usart\+\_\+set\+\_\+dma}} (const \mbox{\hyperlink{usart_8h_a84089acfdd6cff2f2d8a844e76bbf655}{usart\+\_\+peripheral\+\_\+t}} usart, const \+\_\+\+Bool for\+TX, const \+\_\+\+Bool for\+RX)
\begin{DoxyCompactList}\small\item\em Configures the USART DMA functionality. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{usart_8h_a8361f1f285f8d7b9ae851ee7cb4c92df}{usart\+\_\+set\+\_\+interrupts}} (const \mbox{\hyperlink{usart_8h_a84089acfdd6cff2f2d8a844e76bbf655}{usart\+\_\+peripheral\+\_\+t}} usart, const struct \mbox{\hyperlink{structUSARTISR}{USARTISR}} config)
\begin{DoxyCompactList}\small\item\em Enables the specified USART interrupts. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{usart_8h_aa83846fd837fc77d400a5f1af3409917}{usart\+\_\+set\+\_\+databits}} (const \mbox{\hyperlink{usart_8h_a84089acfdd6cff2f2d8a844e76bbf655}{usart\+\_\+peripheral\+\_\+t}} usart, const \mbox{\hyperlink{usart_8h_aec2fddd4341bdbc1ca7e36b9d543d6f9}{usart\+\_\+stopbits\+\_\+t}} stopbits, const \mbox{\hyperlink{usart_8h_a646bb5cdc2347b4c446474ed4d800b28}{usart\+\_\+databits\+\_\+t}} databits)
\begin{DoxyCompactList}\small\item\em Sets the USART databits to the specified values. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{usart_8h_adca849a8d415a84829011ab9c34eed5c}{usart\+\_\+set\+\_\+parity}} (const \mbox{\hyperlink{usart_8h_a84089acfdd6cff2f2d8a844e76bbf655}{usart\+\_\+peripheral\+\_\+t}} usart, const \mbox{\hyperlink{usart_8h_a9b924d5756332a7f8773403d0dd6b708}{usart\+\_\+parity\+\_\+t}} parity)
\begin{DoxyCompactList}\small\item\em Sets the USART parity to the specified mode. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{usart_8h_af5c553a09e20287a276c4d553ba33483}{usart\+\_\+tx\+\_\+message}} (const \mbox{\hyperlink{usart_8h_a84089acfdd6cff2f2d8a844e76bbf655}{usart\+\_\+peripheral\+\_\+t}} usart, const char \texorpdfstring{$\ast$}{*}message)
\begin{DoxyCompactList}\small\item\em Writes specified message to USART buffer. \end{DoxyCompactList}\item 
uint16\+\_\+t \mbox{\hyperlink{usart_8h_aa9bbbb89288476fa1f9ca4162c0ad76c}{usart\+\_\+rx\+\_\+byte}} (const \mbox{\hyperlink{usart_8h_a84089acfdd6cff2f2d8a844e76bbf655}{usart\+\_\+peripheral\+\_\+t}} usart)
\begin{DoxyCompactList}\small\item\em Reads the received data from the USART buffer. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{usart_8h_a71c3522d1b9c9cfa223d15a085a0796d}{usart\+\_\+stop}} (const \mbox{\hyperlink{usart_8h_a84089acfdd6cff2f2d8a844e76bbf655}{usart\+\_\+peripheral\+\_\+t}} usart)
\begin{DoxyCompactList}\small\item\em Disable the USART interface. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Function prototypes for the USART interface. 

This file contains all of the enums, macros, and function prototypes required for a functional usart driver.

\begin{DoxyAuthor}{Author}
Vasileios Ch. (BillisC) 
\end{DoxyAuthor}
\begin{DoxyRefDesc}{Bug}
\item[\mbox{\hyperlink{bug__bug000013}{Bug}}]None, yet. \end{DoxyRefDesc}


\doxysubsection{Macro Definition Documentation}
\Hypertarget{usart_8h_a3977cb9899a567a850c44904025c08dc}\index{usart.h@{usart.h}!USART@{USART}}
\index{USART@{USART}!usart.h@{usart.h}}
\doxysubsubsection{\texorpdfstring{USART}{USART}}
{\footnotesize\ttfamily \label{usart_8h_a3977cb9899a567a850c44904025c08dc} 
\#define USART(\begin{DoxyParamCaption}\item[{}]{x}{}\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{(\textcolor{keyword}{struct\ }\mbox{\hyperlink{structUSARTRegs}{USARTRegs}}\ *)(x)}

\end{DoxyCode}


\doxysubsection{Function Documentation}
\Hypertarget{usart_8h_aa9bbbb89288476fa1f9ca4162c0ad76c}\index{usart.h@{usart.h}!usart\_rx\_byte@{usart\_rx\_byte}}
\index{usart\_rx\_byte@{usart\_rx\_byte}!usart.h@{usart.h}}
\doxysubsubsection{\texorpdfstring{usart\_rx\_byte()}{usart\_rx\_byte()}}
{\footnotesize\ttfamily \label{usart_8h_aa9bbbb89288476fa1f9ca4162c0ad76c} 
uint16\+\_\+t usart\+\_\+rx\+\_\+byte (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{usart_8h_a84089acfdd6cff2f2d8a844e76bbf655}{usart\+\_\+peripheral\+\_\+t}}}]{usart}{}\end{DoxyParamCaption})}



Reads the received data from the USART buffer. 

In receive/transceive mode the data will be read from the DR register and the RXNE flag will be cleared. Beware that this method is very slow and may cause overrun errors if not used in conjuction with interrupts.


\begin{DoxyParams}{Parameters}
{\em usart} & The selected USART \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The received data 
\end{DoxyReturn}
\Hypertarget{usart_8h_aa83846fd837fc77d400a5f1af3409917}\index{usart.h@{usart.h}!usart\_set\_databits@{usart\_set\_databits}}
\index{usart\_set\_databits@{usart\_set\_databits}!usart.h@{usart.h}}
\doxysubsubsection{\texorpdfstring{usart\_set\_databits()}{usart\_set\_databits()}}
{\footnotesize\ttfamily \label{usart_8h_aa83846fd837fc77d400a5f1af3409917} 
void usart\+\_\+set\+\_\+databits (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{usart_8h_a84089acfdd6cff2f2d8a844e76bbf655}{usart\+\_\+peripheral\+\_\+t}}}]{usart}{, }\item[{const \mbox{\hyperlink{usart_8h_aec2fddd4341bdbc1ca7e36b9d543d6f9}{usart\+\_\+stopbits\+\_\+t}}}]{stopbits}{, }\item[{const \mbox{\hyperlink{usart_8h_a646bb5cdc2347b4c446474ed4d800b28}{usart\+\_\+databits\+\_\+t}}}]{databits}{}\end{DoxyParamCaption})}



Sets the USART databits to the specified values. 

The available number of stopbits and databits for the USART are specified in usart\+\_\+stopbits\+\_\+t and usart\+\_\+databits\+\_\+t enums respectively. Any other value will be ignored.


\begin{DoxyParams}{Parameters}
{\em usart} & The selected USART \\
\hline
{\em stopbits} & The number of stop bits \\
\hline
{\em databits} & The word length \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
None 
\end{DoxyReturn}
\Hypertarget{usart_8h_a0455ec8a07f9dacafb4662e78c03c718}\index{usart.h@{usart.h}!usart\_set\_dma@{usart\_set\_dma}}
\index{usart\_set\_dma@{usart\_set\_dma}!usart.h@{usart.h}}
\doxysubsubsection{\texorpdfstring{usart\_set\_dma()}{usart\_set\_dma()}}
{\footnotesize\ttfamily \label{usart_8h_a0455ec8a07f9dacafb4662e78c03c718} 
void usart\+\_\+set\+\_\+dma (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{usart_8h_a84089acfdd6cff2f2d8a844e76bbf655}{usart\+\_\+peripheral\+\_\+t}}}]{usart}{, }\item[{const \+\_\+\+Bool}]{for\+TX}{, }\item[{const \+\_\+\+Bool}]{for\+RX}{}\end{DoxyParamCaption})}



Configures the USART DMA functionality. 


\begin{DoxyParams}{Parameters}
{\em usart} & The selected USART \\
\hline
{\em for\+TX} & Enable / Disable DMA for TX \\
\hline
{\em for\+TX} & Enable / Disable DMA for RX \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
None 
\end{DoxyReturn}
\Hypertarget{usart_8h_a8361f1f285f8d7b9ae851ee7cb4c92df}\index{usart.h@{usart.h}!usart\_set\_interrupts@{usart\_set\_interrupts}}
\index{usart\_set\_interrupts@{usart\_set\_interrupts}!usart.h@{usart.h}}
\doxysubsubsection{\texorpdfstring{usart\_set\_interrupts()}{usart\_set\_interrupts()}}
{\footnotesize\ttfamily \label{usart_8h_a8361f1f285f8d7b9ae851ee7cb4c92df} 
void usart\+\_\+set\+\_\+interrupts (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{usart_8h_a84089acfdd6cff2f2d8a844e76bbf655}{usart\+\_\+peripheral\+\_\+t}}}]{usart}{, }\item[{const struct \mbox{\hyperlink{structUSARTISR}{USARTISR}}}]{config}{}\end{DoxyParamCaption})}



Enables the specified USART interrupts. 

The available interrupts are located in the usart\+\_\+isr struct.


\begin{DoxyParams}{Parameters}
{\em usart} & The selected USART \\
\hline
{\em config} & The ISR configuration \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
None 
\end{DoxyReturn}
\Hypertarget{usart_8h_adca849a8d415a84829011ab9c34eed5c}\index{usart.h@{usart.h}!usart\_set\_parity@{usart\_set\_parity}}
\index{usart\_set\_parity@{usart\_set\_parity}!usart.h@{usart.h}}
\doxysubsubsection{\texorpdfstring{usart\_set\_parity()}{usart\_set\_parity()}}
{\footnotesize\ttfamily \label{usart_8h_adca849a8d415a84829011ab9c34eed5c} 
void usart\+\_\+set\+\_\+parity (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{usart_8h_a84089acfdd6cff2f2d8a844e76bbf655}{usart\+\_\+peripheral\+\_\+t}}}]{usart}{, }\item[{const \mbox{\hyperlink{usart_8h_a9b924d5756332a7f8773403d0dd6b708}{usart\+\_\+parity\+\_\+t}}}]{parity}{}\end{DoxyParamCaption})}



Sets the USART parity to the specified mode. 

The available parity modes for the USART are specified in usart\+\_\+parity\+\_\+t. Any other value will be ignored. Please note that setting the parity modes will automatically set the PCE (parity control) bit. If the mode is "{}off"{} it will be cleared.


\begin{DoxyParams}{Parameters}
{\em usart} & The selected USART \\
\hline
{\em parity} & The selected parity \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
None 
\end{DoxyReturn}
\Hypertarget{usart_8h_ad9c264f63f18256847b7c7b954a17d8d}\index{usart.h@{usart.h}!usart\_start@{usart\_start}}
\index{usart\_start@{usart\_start}!usart.h@{usart.h}}
\doxysubsubsection{\texorpdfstring{usart\_start()}{usart\_start()}}
{\footnotesize\ttfamily \label{usart_8h_ad9c264f63f18256847b7c7b954a17d8d} 
void usart\+\_\+start (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{usart_8h_a84089acfdd6cff2f2d8a844e76bbf655}{usart\+\_\+peripheral\+\_\+t}}}]{usart}{, }\item[{const uint32\+\_\+t}]{baudrate}{, }\item[{const \mbox{\hyperlink{usart_8h_af9cb6192f394ebde038a7b64527eb5e9}{usart\+\_\+mode\+\_\+t}}}]{mode}{}\end{DoxyParamCaption})}



Initiates the USART peripheral with specified options. 

The available modes for the USART peripheral are specified in the usart\+\_\+mode\+\_\+t enum. Any other value will be ignored.


\begin{DoxyParams}{Parameters}
{\em usart} & The selected USART \\
\hline
{\em baudrate} & The desired communication bitrate \\
\hline
{\em mode} & The desired communication mode \\
\hline
{\em x8\+\_\+oversample} & Use x8 oversampling instead of x16 \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
None 
\end{DoxyReturn}
\Hypertarget{usart_8h_a71c3522d1b9c9cfa223d15a085a0796d}\index{usart.h@{usart.h}!usart\_stop@{usart\_stop}}
\index{usart\_stop@{usart\_stop}!usart.h@{usart.h}}
\doxysubsubsection{\texorpdfstring{usart\_stop()}{usart\_stop()}}
{\footnotesize\ttfamily \label{usart_8h_a71c3522d1b9c9cfa223d15a085a0796d} 
void usart\+\_\+stop (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{usart_8h_a84089acfdd6cff2f2d8a844e76bbf655}{usart\+\_\+peripheral\+\_\+t}}}]{usart}{}\end{DoxyParamCaption})}



Disable the USART interface. 

The function will wait until all transmissions are complete and turn off the specified USART peripheral.


\begin{DoxyParams}{Parameters}
{\em usart} & The selected USART \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
None 
\end{DoxyReturn}
\Hypertarget{usart_8h_af5c553a09e20287a276c4d553ba33483}\index{usart.h@{usart.h}!usart\_tx\_message@{usart\_tx\_message}}
\index{usart\_tx\_message@{usart\_tx\_message}!usart.h@{usart.h}}
\doxysubsubsection{\texorpdfstring{usart\_tx\_message()}{usart\_tx\_message()}}
{\footnotesize\ttfamily \label{usart_8h_af5c553a09e20287a276c4d553ba33483} 
void usart\+\_\+tx\+\_\+message (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{usart_8h_a84089acfdd6cff2f2d8a844e76bbf655}{usart\+\_\+peripheral\+\_\+t}}}]{usart}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{message}{}\end{DoxyParamCaption})}



Writes specified message to USART buffer. 

In transmit/transceive mode the data will be written to the DR register and be shifted out of the TX pin when ready. Using it without DMA is not recommended for multibyte messages.


\begin{DoxyParams}{Parameters}
{\em usart} & The selected USART \\
\hline
{\em character} & Pointer to the message \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
None 
\end{DoxyReturn}
